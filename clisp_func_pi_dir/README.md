**Note:** for stack size reasons this version only currently works on SBCL.

